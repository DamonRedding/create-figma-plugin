{"version":3,"file":"file-upload-dropzone-67434a60.js","sources":["../../src/components/file-upload/file-upload-dropzone/file-upload-dropzone.tsx"],"sourcesContent":["import { ComponentChildren, h, JSX } from 'preact'\nimport { useCallback, useState } from 'preact/hooks'\n\nimport { Props } from '../../../types/types.js'\nimport { createClassName } from '../../../utilities/create-class-name.js'\nimport { fileComparator } from '../private/file-comparator.js'\nimport styles from './file-upload-dropzone.module.css'\n\nexport type FileUploadDropzoneProps = {\n  acceptedFileTypes?: Array<string>\n  children: ComponentChildren\n  multiple?: boolean\n  onSelectedFiles?: (files: Array<File>) => void\n  propagateEscapeKeyDown?: boolean\n}\n\nexport function FileUploadDropzone({\n  acceptedFileTypes,\n  children,\n  multiple = false,\n  onSelectedFiles,\n  propagateEscapeKeyDown = true,\n  ...rest\n}: Props<HTMLInputElement, FileUploadDropzoneProps>): JSX.Element {\n  const [isDropActive, setIsDropActive] = useState(false)\n\n  const filterFiles = useCallback(\n    function (files: FileList): Array<File> {\n      const result = Array.prototype.slice.call(files).sort(fileComparator)\n      if (typeof acceptedFileTypes === 'undefined') {\n        return result\n      }\n      return result.filter(function (file): boolean {\n        return acceptedFileTypes.indexOf(file.type) !== -1\n      })\n    },\n    [acceptedFileTypes]\n  )\n\n  const handleBlur = useCallback(function (): void {\n    setIsDropActive(false)\n  }, [])\n\n  const handleChange = useCallback(\n    function (event: JSX.TargetedEvent<HTMLInputElement>): void {\n      if (typeof onSelectedFiles === 'undefined') {\n        return\n      }\n      const files = event.currentTarget.files as FileList\n      onSelectedFiles(filterFiles(files))\n    },\n    [filterFiles, onSelectedFiles]\n  )\n\n  const handleDragEnter = useCallback(function (\n    event: JSX.TargetedDragEvent<HTMLInputElement>\n  ) {\n    event.preventDefault()\n  },\n  [])\n\n  const handleDragOver = useCallback(function (\n    event: JSX.TargetedDragEvent<HTMLInputElement>\n  ): void {\n    event.preventDefault()\n    setIsDropActive(true)\n  },\n  [])\n\n  const handleDragEnd = useCallback(function (\n    event: JSX.TargetedDragEvent<HTMLInputElement>\n  ): void {\n    event.preventDefault()\n    setIsDropActive(false)\n  },\n  [])\n\n  const handleDrop = useCallback(\n    function (event: JSX.TargetedDragEvent<HTMLInputElement>): void {\n      if (typeof onSelectedFiles === 'undefined') {\n        return\n      }\n      event.preventDefault()\n      if (event.dataTransfer === null) {\n        throw new Error('`event.dataTransfer` is `null`')\n      }\n      const files = filterFiles(event.dataTransfer.files)\n      onSelectedFiles(files)\n      setIsDropActive(false)\n    },\n    [filterFiles, onSelectedFiles]\n  )\n\n  const handleKeyDown = useCallback(\n    function (event: JSX.TargetedKeyboardEvent<HTMLInputElement>): void {\n      if (event.key !== 'Escape') {\n        return\n      }\n      if (propagateEscapeKeyDown === false) {\n        event.stopPropagation()\n      }\n      event.currentTarget.blur()\n    },\n    [propagateEscapeKeyDown]\n  )\n\n  return (\n    <div\n      class={createClassName([\n        styles.fileUploadDropzone,\n        isDropActive === true ? styles.isDropActive : null\n      ])}\n    >\n      <input\n        {...rest}\n        accept={\n          typeof acceptedFileTypes === 'undefined'\n            ? undefined\n            : acceptedFileTypes.join(',')\n        }\n        class={styles.input}\n        multiple={multiple}\n        onBlur={handleBlur}\n        onChange={handleChange}\n        onDragEnd={handleDragEnd}\n        onDragEnter={handleDragEnter}\n        onDragOver={handleDragOver}\n        onDrop={handleDrop}\n        onKeyDown={handleKeyDown}\n        tabIndex={0}\n        title=\"\"\n        type=\"file\"\n      />\n      <div class={styles.fill} />\n      <div class={styles.border} />\n      <div class={styles.children}>{children}</div>\n    </div>\n  )\n}\n"],"names":["FileUploadDropzone","acceptedFileTypes","children","multiple","onSelectedFiles","propagateEscapeKeyDown","rest","isDropActive","setIsDropActive","useState","filterFiles","useCallback","files","result","Array","prototype","slice","call","sort","fileComparator","filter","file","indexOf","type","handleBlur","handleChange","event","currentTarget","handleDragEnter","preventDefault","handleDragOver","handleDragEnd","handleDrop","dataTransfer","Error","handleKeyDown","key","stopPropagation","blur","_jsxs","class","createClassName","styles","fileUploadDropzone","_jsx","accept","undefined","join","input","onBlur","onChange","onDragEnd","onDragEnter","onDragOver","onDrop","onKeyDown","tabIndex","title","fill","border"],"mappings":"oZAgBO,SAASA,EAAmB,CACjCC,kBAAAA,EACAC,SAAAA,EACAC,SAAAA,EAAW,GACXC,gBAAAA,EACAC,uBAAAA,EAAyB,GACzB,GAAGC,CAC6C,EAAgB,CAChE,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAS,EAAK,EAEhDC,EAAcC,EAClB,SAAUC,EAA8B,CAChCC,MAAAA,EAASC,MAAMC,UAAUC,MAAMC,KAAKL,CAAK,EAAEM,KAAKC,CAAc,EAChE,OAAA,OAAOlB,EAAsB,IACxBY,EAEFA,EAAOO,OAAO,SAAUC,EAAe,CAC5C,OAAOpB,EAAkBqB,QAAQD,EAAKE,IAAI,IAAM,EAAA,CACjD,CAAA,EAEH,CAACtB,CAAiB,CACpB,EAEMuB,EAAab,EAAY,UAAkB,CAC/CH,EAAgB,EAAK,CACvB,EAAG,CAAE,CAAA,EAECiB,EAAed,EACnB,SAAUe,EAAkD,CACtD,GAAA,OAAOtB,EAAoB,IAC7B,OAEIQ,MAAAA,EAAQc,EAAMC,cAAcf,MAClBF,EAAAA,EAAYE,CAAK,CAAC,CAAA,EAEpC,CAACF,EAAaN,CAAe,CAC/B,EAEMwB,EAAkBjB,EAAY,SAClCe,EACA,CACAA,EAAMG,eAAe,CACvB,EACA,CAAE,CAAA,EAEIC,EAAiBnB,EAAY,SACjCe,EACM,CACNA,EAAMG,eAAe,EACrBrB,EAAgB,EAAI,CACtB,EACA,CAAE,CAAA,EAEIuB,EAAgBpB,EAAY,SAChCe,EACM,CACNA,EAAMG,eAAe,EACrBrB,EAAgB,EAAK,CACvB,EACA,CAAE,CAAA,EAEIwB,EAAarB,EACjB,SAAUe,EAAsD,CAC1D,GAAA,OAAOtB,EAAoB,IAC7B,OAGEsB,GADJA,EAAMG,eAAe,EACjBH,EAAMO,eAAiB,KACnB,MAAA,IAAIC,MAAM,gCAAgC,EAElD,MAAMtB,EAAQF,EAAYgB,EAAMO,aAAarB,KAAK,EAClDR,EAAgBQ,CAAK,EACrBJ,EAAgB,EAAK,CAAA,EAEvB,CAACE,EAAaN,CAAe,CAC/B,EAEM+B,EAAgBxB,EACpB,SAAUe,EAA0D,CAC9DA,EAAMU,MAAQ,WAGd/B,IAA2B,IAC7BqB,EAAMW,gBAAgB,EAExBX,EAAMC,cAAcW,OAAK,EAE3B,CAACjC,CAAsB,CACzB,EAEA,OACEkC,EAAA,MAAA,CACEC,MAAOC,EAAgB,CACrBC,EAAOC,mBACPpC,IAAiB,GAAOmC,EAAOnC,aAAe,IAAI,CACnD,EAAEL,UAEH0C,EAAA,QAAA,CAAA,GACMtC,EACJuC,OACE,OAAO5C,EAAsB,IACzB6C,OACA7C,EAAkB8C,KAAK,GAAG,EAEhCP,MAAOE,EAAOM,MACd7C,SAAAA,EACA8C,OAAQzB,EACR0B,SAAUzB,EACV0B,UAAWpB,EACXqB,YAAaxB,EACbyB,WAAYvB,EACZwB,OAAQtB,EACRuB,UAAWpB,EACXqB,SAAU,EACVC,MAAM,GACNlC,KAAK,MAAA,CACN,EACDqB,EAAA,MAAA,CAAKJ,MAAOE,EAAOgB,IAAAA,CAAO,EAC1Bd,EAAA,MAAA,CAAKJ,MAAOE,EAAOiB,MAAAA,CAAS,EAC5Bf,EAAA,MAAA,CAAKJ,MAAOE,EAAOxC,SAASA,SAAAA,CAAAA,CAAgB,CAAC,CAAA,CAC1C,CAET"}