{"version":3,"file":"file-upload-button-ff119540.js","sources":["../../src/components/file-upload/file-upload-button/file-upload-button.tsx"],"sourcesContent":["import { ComponentChildren, h } from 'preact'\nimport { useCallback } from 'preact/hooks'\n\nimport { Event, EventHandler } from '../../../types/event-handler.js'\nimport { FocusableComponentProps } from '../../../types/focusable-component-props.js'\nimport { createClassName } from '../../../utilities/create-class-name.js'\nimport { createComponent } from '../../../utilities/create-component.js'\nimport { noop } from '../../../utilities/no-op.js'\nimport buttonStyles from '../../button/button.module.css'\nimport { LoadingIndicator } from '../../loading-indicator/loading-indicator.js'\nimport { fileComparator } from '../private/file-comparator.js'\nimport fileUploadButtonStyles from './file-upload-button.module.css'\n\nexport interface FileUploadButtonProps\n  extends FocusableComponentProps<HTMLInputElement> {\n  acceptedFileTypes?: Array<string>\n  children: ComponentChildren\n  disabled?: boolean\n  fullWidth?: boolean\n  loading?: boolean\n  multiple?: boolean\n  onChange?: EventHandler.onChange<HTMLInputElement>\n  onClick?: EventHandler.onClick<HTMLInputElement>\n  onMouseDown?: EventHandler.onMouseDown<HTMLInputElement>\n  onSelectedFiles?: EventHandler.onSelectedFiles\n  secondary?: boolean\n}\n\nexport const FileUploadButton = createComponent<\n  HTMLInputElement,\n  FileUploadButtonProps\n>(function (\n  {\n    acceptedFileTypes = [],\n    children,\n    disabled = false,\n    fullWidth = false,\n    loading = false,\n    multiple = false,\n    onChange = noop,\n    onClick = noop,\n    onKeyDown = noop,\n    onMouseDown = noop,\n    onSelectedFiles = noop,\n    propagateEscapeKeyDown = true,\n    secondary = false,\n    ...rest\n  },\n  ref\n) {\n  const handleChange = useCallback(\n    function (event: Event.onChange<HTMLInputElement>) {\n      onChange(event)\n      const fileList = event.currentTarget.files\n      if (fileList === null) {\n        throw new Error('`event.currentTarget.files` is `null`')\n      }\n      const files = parseFileList(fileList)\n      if (files.length > 0) {\n        onSelectedFiles(files)\n      }\n    },\n    [onChange, onSelectedFiles]\n  )\n\n  const handleClick = useCallback(\n    function (event: Event.onClick<HTMLInputElement>) {\n      onClick(event)\n      if (loading === true) {\n        event.preventDefault()\n      }\n    },\n    [onClick, loading]\n  )\n\n  const handleMouseDown = useCallback(\n    function (event: Event.onClick<HTMLInputElement>) {\n      onMouseDown(event)\n      event.currentTarget.focus()\n    },\n    [onMouseDown]\n  )\n\n  const handleKeyDown = useCallback(\n    function (event: Event.onKeyDown<HTMLInputElement>) {\n      onKeyDown(event)\n      if (event.key === 'Escape') {\n        if (propagateEscapeKeyDown === false) {\n          event.stopPropagation()\n        }\n        event.currentTarget.blur()\n      }\n    },\n    [onKeyDown, propagateEscapeKeyDown]\n  )\n\n  return (\n    <div\n      class={createClassName([\n        buttonStyles.button,\n        secondary === true ? buttonStyles.secondary : buttonStyles.default,\n        secondary === true\n          ? fileUploadButtonStyles.secondary\n          : fileUploadButtonStyles.default,\n        fullWidth === true ? buttonStyles.fullWidth : null,\n        disabled === true ? buttonStyles.disabled : null,\n        disabled === true ? fileUploadButtonStyles.disabled : null,\n        loading === true ? buttonStyles.loading : null\n      ])}\n    >\n      {loading === true ? (\n        <div class={buttonStyles.loadingIndicator}>\n          <LoadingIndicator />\n        </div>\n      ) : null}\n      <input\n        {...rest}\n        ref={ref}\n        accept={\n          acceptedFileTypes.length === 0\n            ? undefined\n            : acceptedFileTypes.join(',')\n        }\n        class={fileUploadButtonStyles.input}\n        disabled={disabled === true}\n        multiple={multiple}\n        onChange={handleChange}\n        onClick={handleClick}\n        onKeyDown={handleKeyDown}\n        onMouseDown={handleMouseDown}\n        tabIndex={0}\n        title=\"\"\n        type=\"file\"\n      />\n      <button disabled={disabled === true} tabIndex={-1}>\n        <div class={buttonStyles.children}>{children}</div>\n      </button>\n    </div>\n  )\n})\n\nfunction parseFileList(fileList: FileList): Array<File> {\n  return Array.prototype.slice.call(fileList).sort(fileComparator)\n}\n"],"names":["FileUploadButton","createComponent","acceptedFileTypes","children","disabled","fullWidth","loading","multiple","onChange","noop","onClick","onKeyDown","onMouseDown","onSelectedFiles","propagateEscapeKeyDown","secondary","rest","ref","handleChange","useCallback","event","fileList","currentTarget","files","Error","parseFileList","length","handleClick","preventDefault","handleMouseDown","focus","handleKeyDown","key","stopPropagation","blur","_jsxs","class","createClassName","buttonStyles","button","default","fileUploadButtonStyles","_jsx","loadingIndicator","LoadingIndicator","accept","undefined","join","input","tabIndex","title","type","Array","prototype","slice","call","sort","fileComparator"],"mappings":"ueA4BaA,EAAmBC,EAG9B,SACA,CACEC,kBAAAA,EAAoB,CAAE,EACtBC,SAAAA,EACAC,SAAAA,EAAW,GACXC,UAAAA,EAAY,GACZC,QAAAA,EAAU,GACVC,SAAAA,EAAW,GACXC,SAAAA,EAAWC,EACXC,QAAAA,EAAUD,EACVE,UAAAA,EAAYF,EACZG,YAAAA,EAAcH,EACdI,gBAAAA,EAAkBJ,EAClBK,uBAAAA,EAAyB,GACzBC,UAAAA,EAAY,GACZ,GAAGC,CACL,EACAC,EACA,CACMC,MAAAA,EAAeC,EACnB,SAAUC,EAAyC,CACjDZ,EAASY,CAAK,EACRC,MAAAA,EAAWD,EAAME,cAAcC,MACrC,GAAIF,IAAa,KACT,MAAA,IAAIG,MAAM,uCAAuC,EAEnDD,MAAAA,EAAQE,EAAcJ,CAAQ,EAChCE,EAAMG,OAAS,GACjBb,EAAgBU,CAAK,CACvB,EAEF,CAACf,EAAUK,CAAe,CAC5B,EAEMc,EAAcR,EAClB,SAAUC,EAAwC,CAChDV,EAAQU,CAAK,EACTd,IAAY,IACdc,EAAMQ,eAAe,CACvB,EAEF,CAAClB,EAASJ,CAAO,CACnB,EAEMuB,EAAkBV,EACtB,SAAUC,EAAwC,CAChDR,EAAYQ,CAAK,EACjBA,EAAME,cAAcQ,OAAM,EAE5B,CAAClB,CAAW,CACd,EAEMmB,EAAgBZ,EACpB,SAAUC,EAA0C,CAClDT,EAAUS,CAAK,EACXA,EAAMY,MAAQ,WACZlB,IAA2B,IAC7BM,EAAMa,gBAAgB,EAExBb,EAAME,cAAcY,OACtB,EAEF,CAACvB,EAAWG,CAAsB,CACpC,EAEA,OACEqB,EAAA,MAAA,CACEC,MAAOC,EAAgB,CACrBC,EAAaC,OACbxB,IAAc,GAAOuB,EAAavB,UAAYuB,EAAaE,QAC3DzB,IAAc,GACV0B,EAAuB1B,UACvB0B,EAAuBD,QAC3BnC,IAAc,GAAOiC,EAAajC,UAAY,KAC9CD,IAAa,GAAOkC,EAAalC,SAAW,KAC5CA,IAAa,GAAOqC,EAAuBrC,SAAW,KACtDE,IAAY,GAAOgC,EAAahC,QAAU,IAAI,CAC/C,EAAEH,SAEFG,CAAAA,IAAY,GACXoC,EAAA,MAAA,CAAKN,MAAOE,EAAaK,iBAAiBxC,SACxCuC,EAACE,EAAkB,EAAA,CAAA,CAChB,EACH,KACJF,EAAA,QAAA,CAAA,GACM1B,EACJC,IAAAA,EACA4B,OACE3C,EAAkBwB,SAAW,EACzBoB,OACA5C,EAAkB6C,KAAK,GAAG,EAEhCX,MAAOK,EAAuBO,MAC9B5C,SAAUA,IAAa,GACvBG,SAAAA,EACAC,SAAUU,EACVR,QAASiB,EACThB,UAAWoB,EACXnB,YAAaiB,EACboB,SAAU,EACVC,MAAM,GACNC,KAAK,MAAA,CACN,EACDT,EAAA,SAAA,CAAQtC,SAAUA,IAAa,GAAM6C,SAAU,GAAG9C,SAChDuC,EAAA,MAAA,CAAKN,MAAOE,EAAanC,SAASA,SAAAA,CAAAA,CAAgB,CAAA,CAC5C,CAAC,CAAA,CACN,CAET,CAAC,EAED,SAASsB,EAAcJ,EAAiC,CACtD,OAAO+B,MAAMC,UAAUC,MAAMC,KAAKlC,CAAQ,EAAEmC,KAAKC,CAAc,CACjE"}