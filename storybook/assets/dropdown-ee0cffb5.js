import{T as g,_ as B,h as V}from"./hooks.module-6e460002.js";import{u as U,m as E}from"./use-mouse-down-outside-a27f62ba.js";import{g as H}from"./get-current-from-ref-47f174f6.js";import{I as G}from"./icon-control-chevron-down-8-44d6ef4a.js";import{I as z}from"./icon-menu-checkmark-checked-16-63abc2a0.js";import{c as $}from"./create-class-name-71c46838.js";import{o as h}from"./jsxRuntime.module-893eb125.js";function J(n){const{itemIdDataAttributeName:e,menuElementRef:o,selectedId:t,setSelectedId:d}=n,i=g(function(){return Array.from(H(o).querySelectorAll(`[${e}]`)).filter(function(c){return c.hasAttribute("disabled")===!1})},[e,o]),s=g(function(c){if(c===null)return-1;const a=i().findIndex(function(m){return m.getAttribute(e)===c});if(a===-1)throw new Error("Invariant violation");return a},[i,e]),l=g(function(c){const a=i(),m=s(c),I=a[m],u=H(o),M=u.scrollTop,T=Q(I,u);if(T<M){u.scrollTop=T;return}const A=T+I.offsetHeight;A>u.scrollTop+u.offsetHeight&&(u.scrollTop=A-u.offsetHeight)},[s,i,o]),w=g(function(c){const a=c.key;if(a==="ArrowDown"||a==="ArrowUp"){const m=i(),I=s(t);let u;a==="ArrowDown"?u=I===-1||I===m.length-1?0:I+1:u=I===-1||I===0?m.length-1:I-1;const T=m[u].getAttribute(e);d(T),l(T)}},[i,s,e,d,t,l]);return{handleScrollableMenuItemMouseMove:g(function(c){const a=c.currentTarget.getAttribute(e);a!==t&&d(a)},[e,t,d]),handleScrollableMenuKeyDown:w}}function Q(n,e){let o=n,t=0;for(;o!==e;){if(t+=o.offsetTop,o.parentElement===null)throw new Error("`element.parentElement` is `null`");o=o.parentElement}return t}const X="_dropdown_idjri_1",Y="_disabled_idjri_12",Z="_icon_idjri_21",ee="_empty_idjri_33",te="_value_idjri_37",ne="_hasIcon_idjri_51",oe="_placeholder_idjri_55",re="_chevronIcon_idjri_59",le="_border_idjri_70",ie="_hasBorder_idjri_79",ce="_underline_idjri_84",se="_menu_idjri_97",p={dropdown:X,disabled:Y,icon:Z,empty:ee,value:te,hasIcon:ne,placeholder:oe,chevronIcon:re,border:le,hasBorder:ie,underline:ce,menu:se},R=null,D="data-dropdown-item-id",v=16;function ue(n,e,o){const t=window.innerWidth-2*v,d=window.innerHeight-2*v;e.style.maxWidth=`${t}px`,e.style.maxHeight=`${d}px`;const i=de(e,o),s=n.getBoundingClientRect(),l=e.offsetHeight===d,w=ae({menuWidth:e.offsetWidth,rootLeft:s.left}),_=fe({isScrollable:l,menuHeight:e.offsetHeight,rootHeight:n.offsetHeight,rootTop:s.top,selectedTop:i===null?null:i.offsetTop});e.style.left=`${w}px`,e.style.top=`${_}px`,i!==null&&l===!0&&(e.scrollTop=he({menuHeight:e.offsetHeight,menuScrollHeight:e.scrollHeight,menuTop:e.getBoundingClientRect().top,rootHeight:n.offsetHeight,rootTop:s.top,selectedHeight:i.offsetHeight,selectedTop:i.offsetTop}))}function de(n,e){if(e===R)return null;const o=n.querySelector(`[${D}='${e}']`);if(o===null)throw new Error("Invariant violation");const t=o.parentElement;if(t===null)throw new Error("Invariant violation");return t}function ae(n){const{rootLeft:e,menuWidth:o}=n;if(e<=v)return y(e)+v;const t=y(e+o-(window.innerWidth-v));return Math.min(t,0)}function fe(n){const e=window.innerHeight,{isScrollable:o,menuHeight:t,rootHeight:d,rootTop:i,selectedTop:s}=n;if(i<=v)return y(i)+v;if(i+d>=e-v)return y(i-(e-v-t));const l=y(i-v),w=e-v-t-i;if(s===null||o===!0){const _=Math.min(y((t-d)/2),0);return x(_,l,w)}return x(y(s),l,w)}function he(n){const e=window.innerHeight,{menuHeight:o,menuScrollHeight:t,menuTop:d,rootHeight:i,rootTop:s,selectedTop:l,selectedHeight:w}=n,_=0,c=t-o;return s<=d?x(l,_,c):s+i>=e-v?x(l+w-o,_,c):x(l-s+d,_,c)}function y(n){return-1*n}function x(n,e,o){return Math.min(Math.max(n,e),o)}function Te({disabled:n=!1,icon:e,name:o,options:t,onChange:d=function(){},onValueChange:i=function(){},placeholder:s,value:l,variant:w,..._}){if(typeof e=="string"&&e.length!==1)throw new Error(`String \`icon\` must be a single character: ${e}`);const c=B(null),a=B(null),[m,I]=V(!1),u=C(t,l);if(l!==null&&u===-1)throw new Error(`Invalid \`value\`: ${l}`);const[M,T]=V(u===-1?R:`${u}`),A=typeof t[u]>"u"?"":me(t[u]),{handleScrollableMenuKeyDown:k,handleScrollableMenuItemMouseMove:L}=J({itemIdDataAttributeName:D,menuElementRef:a,selectedId:M,setSelectedId:T}),b=g(function(){I(!1),T(R),H(c).blur()},[]),j=g(function(r){const f=H(c),S=H(a);ue(f,S,r)},[]),O=g(function(){if(m===!0)return;if(I(!0),l===null){j(M);return}const r=C(t,l);if(r===-1)throw new Error(`Invalid \`value\`: ${l}`);const f=`${r}`;T(f),j(f)},[m,t,M,j,l]),W=g(function(r){if(r.key==="Escape"||r.key==="Tab"){b();return}if(r.key==="Enter"){if(M!==R){const f=H(a).querySelector(`[${D}='${M}']`);if(f===null)throw new Error("Invariant violation");f.checked=!0;const S=document.createEvent("Event");S.initEvent("change",!0,!0),f.dispatchEvent(S)}b();return}k(r)},[k,M,b]),N=g(function(r){m!==!1&&(r.preventDefault(),b())},[m,b]),K=g(function(r){r.stopPropagation()},[]),q=g(function(r){const f=r.currentTarget.getAttribute(D),P=t[parseInt(f,10)].value;i(P,o),d(r),b()},[o,d,i,t,b]),F=g(function(){m!==!1&&b()},[m,b]);return U({onMouseDownOutside:F,ref:c}),h("div",{..._,ref:c,class:$([p.dropdown,typeof w>"u"?null:w==="border"?p.hasBorder:null,typeof e>"u"?null:p.hasIcon,n===!0?p.disabled:null]),onFocus:O,onKeyDown:n===!0?void 0:W,onMouseDown:N,tabIndex:n===!0?-1:0,children:[typeof e>"u"?null:h("div",{class:p.icon,children:e}),l===null?typeof s>"u"?h("div",{class:p.empty}):h("div",{class:$([p.value,p.placeholder]),children:s}):h("div",{class:p.value,children:A}),h("div",{class:p.chevronIcon,children:h(G,{})}),w==="underline"?h("div",{class:p.underline}):null,h("div",{class:p.border}),h("div",{ref:a,class:$([E.menu,p.menu,n===!0||m===!1?E.hidden:null]),onMouseDown:K,children:t.map(function(r,f){return"separator"in r?h("hr",{class:E.optionSeparator},f):"header"in r?h("h1",{class:E.optionHeader,children:r.header},f):h("label",{class:$([E.optionValue,r.disabled===!0?E.optionValueDisabled:null,r.disabled!==!0&&`${f}`===M?E.optionValueSelected:null]),children:[h("input",{checked:l===r.value,class:E.input,disabled:r.disabled===!0,name:o,onChange:l===r.value?void 0:q,onClick:l===r.value?b:void 0,onMouseMove:L,tabIndex:-1,type:"radio",value:`${r.value}`,[D]:`${f}`}),r.value===l?h("div",{class:E.checkIcon,children:h(z,{})}):null,typeof r.text>"u"?r.value:r.text]},f)})})]})}function me(n){if("text"in n)return n.text;if("value"in n)return n.value;throw new Error("Invariant violation")}function C(n,e){if(e===null)return-1;let o=0;for(const t of n){if("value"in t&&t.value===e)return o;o+=1}return-1}export{Te as D};
//# sourceMappingURL=dropdown-ee0cffb5.js.map
