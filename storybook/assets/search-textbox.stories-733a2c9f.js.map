{"version":3,"file":"search-textbox.stories-733a2c9f.js","sources":["../../src/components/search-textbox/search-textbox.tsx"],"sourcesContent":["import { h, JSX, RefObject } from 'preact'\nimport { useCallback, useRef } from 'preact/hooks'\n\nimport { IconCross32 } from '../../icons/icon-32/icon-cross-32.js'\nimport { IconSearch32 } from '../../icons/icon-32/icon-search-32.js'\nimport { OnValueChange, Props } from '../../types/types.js'\nimport { createClassName } from '../../utilities/create-class-name.js'\nimport { getCurrentFromRef } from '../../utilities/get-current-from-ref.js'\nimport styles from './search-textbox.module.css'\n\nconst EMPTY_STRING = ''\n\nexport type SearchTextboxProps<Name extends string> = {\n  clearOnEscapeKeyDown?: boolean\n  disabled?: boolean\n  name?: Name\n  onFocus?: OmitThisParameter<JSX.FocusEventHandler<HTMLInputElement>>\n  onInput?: OmitThisParameter<JSX.GenericEventHandler<HTMLInputElement>>\n  onKeyDown?: OmitThisParameter<JSX.KeyboardEventHandler<HTMLInputElement>>\n  onValueInput?: OnValueChange<string, Name>\n  placeholder?: string\n  propagateEscapeKeyDown?: boolean\n  spellCheck?: boolean\n  value: string\n}\n\nexport function SearchTextbox<Name extends string>({\n  clearOnEscapeKeyDown = false,\n  disabled = false,\n  name,\n  onFocus = function () {},\n  onInput = function () {},\n  onKeyDown = function () {},\n  onValueInput = function () {},\n  placeholder,\n  propagateEscapeKeyDown = true,\n  spellCheck = false,\n  value,\n  ...rest\n}: Props<HTMLInputElement, SearchTextboxProps<Name>>): JSX.Element {\n  const inputElementRef: RefObject<HTMLInputElement> = useRef(null)\n\n  const handleClearButtonClick = useCallback(function (): void {\n    const inputElement = getCurrentFromRef(inputElementRef)\n    inputElement.value = EMPTY_STRING\n    const inputEvent = document.createEvent('Event')\n    inputEvent.initEvent('input', true, true)\n    inputElement.dispatchEvent(inputEvent)\n    inputElement.focus()\n  }, [])\n\n  const handleFocus = useCallback(\n    function (event: JSX.TargetedFocusEvent<HTMLInputElement>): void {\n      onFocus(event)\n      event.currentTarget.select()\n    },\n    [onFocus]\n  )\n\n  const handleInput = useCallback(\n    function (event: JSX.TargetedEvent<HTMLInputElement>): void {\n      onValueInput(event.currentTarget.value, name)\n      onInput(event)\n    },\n    [name, onInput, onValueInput]\n  )\n\n  const handleKeyDown = useCallback(\n    function (event: JSX.TargetedKeyboardEvent<HTMLInputElement>): void {\n      onKeyDown(event)\n      if (event.key !== 'Escape') {\n        return\n      }\n      if (\n        clearOnEscapeKeyDown === true &&\n        value !== EMPTY_STRING &&\n        value !== null\n      ) {\n        event.stopPropagation() // Clear the value without bubbling up the `Escape` key press\n        handleClearButtonClick()\n        return\n      }\n      if (propagateEscapeKeyDown === false) {\n        event.stopPropagation()\n      }\n      event.currentTarget.blur()\n    },\n    [\n      clearOnEscapeKeyDown,\n      handleClearButtonClick,\n      onKeyDown,\n      propagateEscapeKeyDown,\n      value\n    ]\n  )\n\n  return (\n    <div\n      class={createClassName([\n        styles.searchTextbox,\n        disabled === true ? styles.disabled : null\n      ])}\n    >\n      <input\n        {...rest}\n        ref={inputElementRef}\n        class={styles.input}\n        disabled={disabled === true}\n        name={name}\n        onFocus={handleFocus}\n        onInput={handleInput}\n        onKeyDown={handleKeyDown}\n        placeholder={placeholder}\n        spellcheck={spellCheck}\n        tabIndex={0}\n        type=\"text\"\n        value={value === null ? EMPTY_STRING : value}\n      />\n      <div class={styles.searchIcon}>\n        <IconSearch32 />\n      </div>\n      {value === null || value === EMPTY_STRING || disabled === true ? null : (\n        <button\n          class={styles.clearButton}\n          onClick={handleClearButtonClick}\n          tabIndex={0}\n        >\n          <IconCross32 />\n        </button>\n      )}\n    </div>\n  )\n}\n"],"names":["EMPTY_STRING","SearchTextbox","clearOnEscapeKeyDown","disabled","name","onFocus","onInput","onKeyDown","onValueInput","placeholder","propagateEscapeKeyDown","spellCheck","value","rest","inputElementRef","useRef","handleClearButtonClick","useCallback","inputElement","getCurrentFromRef","inputEvent","document","createEvent","initEvent","dispatchEvent","focus","handleFocus","event","currentTarget","select","handleInput","handleKeyDown","key","stopPropagation","blur","_jsxs","class","createClassName","styles","searchTextbox","children","_jsx","ref","input","spellcheck","tabIndex","type","searchIcon","IconSearch32","clearButton","onClick","IconCross32"],"mappings":"uoBAUMA,EAAe,GAgBd,SAASC,EAAmC,CACjDC,qBAAAA,EAAuB,GACvBC,SAAAA,EAAW,GACXC,KAAAA,EACAC,QAAAA,EAAU,UAAY,CAAC,EACvBC,QAAAA,EAAU,UAAY,CAAC,EACvBC,UAAAA,EAAY,UAAY,CAAC,EACzBC,aAAAA,EAAe,UAAY,CAAC,EAC5BC,YAAAA,GACAC,uBAAAA,EAAyB,GACzBC,WAAAA,GAAa,GACbC,MAAAA,EACA,GAAGC,EAC8C,EAAgB,CAC3DC,MAAAA,EAA+CC,GAAO,IAAI,EAE1DC,EAAyBC,EAAY,UAAkB,CACrDC,MAAAA,EAAeC,GAAkBL,CAAe,EACtDI,EAAaN,MAAQZ,EACfoB,MAAAA,EAAaC,SAASC,YAAY,OAAO,EACpCC,EAAAA,UAAU,QAAS,GAAM,EAAI,EACxCL,EAAaM,cAAcJ,CAAU,EACrCF,EAAaO,MAAM,CACrB,EAAG,CAAE,CAAA,EAECC,GAAcT,EAClB,SAAUU,EAAuD,CAC/DtB,EAAQsB,CAAK,EACbA,EAAMC,cAAcC,QAAO,EAE7B,CAACxB,CAAO,CACV,EAEMyB,GAAcb,EAClB,SAAUU,EAAkD,CAC7CA,EAAAA,EAAMC,cAAchB,MAAOR,CAAI,EAC5CE,EAAQqB,CAAK,CAEf,EAAA,CAACvB,EAAME,EAASE,CAAY,CAC9B,EAEMuB,GAAgBd,EACpB,SAAUU,EAA0D,CAE9DA,GADJpB,EAAUoB,CAAK,EACXA,EAAMK,MAAQ,SAGlB,IACE9B,IAAyB,IACzBU,IAAUZ,GACVY,IAAU,KACV,CACAe,EAAMM,gBAAgB,EACCjB,IACvB,MACF,CACIN,IAA2B,IAC7BiB,EAAMM,gBAAgB,EAExBN,EAAMC,cAAcM,OAAK,EAE3B,CACEhC,EACAc,EACAT,EACAG,EACAE,CAAK,CAET,EAEA,OACEuB,EAAA,MAAA,CACEC,MAAOC,GAAgB,CACrBC,EAAOC,cACPpC,IAAa,GAAOmC,EAAOnC,SAAW,IAAI,CAC3C,EAAEqC,UAEHC,EAAA,QAAA,CAAA,GACM5B,GACJ6B,IAAK5B,EACLsB,MAAOE,EAAOK,MACdxC,SAAUA,IAAa,GACvBC,KAAAA,EACAC,QAASqB,GACTpB,QAASwB,GACTvB,UAAWwB,GACXtB,YAAAA,GACAmC,WAAYjC,GACZkC,SAAU,EACVC,KAAK,OACLlC,MAAOA,IAAU,KAAOZ,EAAeY,CAAAA,CACxC,EACD6B,EAAA,MAAA,CAAKL,MAAOE,EAAOS,WAAWP,SAC5BC,EAACO,GAAc,EAAA,CAAA,CACZ,EACJpC,IAAU,MAAQA,IAAUZ,GAAgBG,IAAa,GAAO,KAC/DsC,EAAA,SAAA,CACEL,MAAOE,EAAOW,YACdC,QAASlC,EACT6B,SAAU,EAAEL,SAEZC,EAACU,GAAa,EAAA,CAAA,CACR,CACT,CAAA,CACE,CAET;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}