import{c as Ee,_ as k,h as R,T as s}from"./create-component-b0512abd.js";import{u as Ie,m}from"./use-mouse-down-outside-bb94ce97.js";import{I as Ve}from"./icon-menu-checkmark-checked-16-11f1d34a.js";import{c as W}from"./create-class-name-71c46838.js";import{g as E}from"./get-current-from-ref-47f174f6.js";import{n as I}from"./no-op-cb277961.js";import{a as p,I as v,V as X}from"./constants-4a59d305.js";import{c as Z}from"./compute-next-value-3d847061.js";import{i as De}from"./is-keycode-character-generating-0746a523.js";import{t as w}from"./textbox.module-917ccc0f.js";import{o as c}from"./jsxRuntime.module-632ba37d.js";const Me="_top_3lpap_1",Ce="_bottom_3lpap_5",ee={top:Me,bottom:Ce},B="",We=Ee(function({disabled:t=!1,filter:n=!1,icon:r,onChange:i=I,onInput:u=I,onKeyDown:F=I,onMouseDown:q=I,onPaste:Y=I,onValueInput:j=I,placeholder:ce,propagateEscapeKeyDown:z=!0,revertOnEscapeKeyDown:J=!1,spellCheck:ae=!1,strict:O=!1,top:H=!1,value:h,variant:N,...$},V){if(typeof r=="string"&&r.length!==1)throw new Error(`String \`icon\` must be a single character: ${r}`);const L=k(null),A=k(null),P=k(null),U=k(!1),[G,de]=R(h),[K,pe]=R(B),[a,Q]=R(!1),[y,D]=R(p),f=n===!0?Oe(te($.options),h,K):te($.options),b=s(function(){E(A).select()},[]),S=s(function(){E(A).blur()},[]),M=s(function(e){const o=E(P);if(e===p){o.scrollTop=0;return}const l=o.querySelector(`[${v}='${e}']`);if(l===null)throw new Error("`selectedElement` is `null`");const d=l.getBoundingClientRect().y-o.getBoundingClientRect().y;if(d<o.scrollTop){o.scrollTop=d;return}const C=d+l.offsetHeight;C>o.scrollTop+o.offsetHeight&&(o.scrollTop=C-o.offsetHeight)},[]),_=s(function(e){const o=le(f,e);o===p&&pe(e),D(o),M(o)},[f,M]),T=s(function(e){const o=E(A);o.value=e;const l=new window.Event("input",{bubbles:!0,cancelable:!0});o.dispatchEvent(l)},[]),g=s(function(){Q(!1)},[]),x=s(function(){ke(E(L),E(P),H),de(h),_(h),Q(!0)},[H,_,h]),he=s(function(e){u(e);const o=e.currentTarget.value;if(_(o),j(o),a!==!0){if(U.current===!0){U.current=!1;return}x()}},[a,u,j,x,_]),ge=s(function(e){F(e);const o=e.currentTarget,l=e.key;if(l==="ArrowUp"||l==="ArrowDown"){if(e.preventDefault(),a===!1){x();return}if(f.length===0)return;const d=l==="ArrowUp"?Ae(f,y):Se(f,y);if(d===p){D(p),T(K),b(),M(p);return}D(d);const C=oe(f,d);if(C===null)throw new Error("`optionValue` is `null`");T(C.value),b(),M(d);return}if(l==="Escape"){if(e.preventDefault(),z===!1&&e.stopPropagation(),J===!0&&(U.current=!0,T(G)),a===!0){g();return}S();return}if(l==="Enter"){if(e.preventDefault(),b(),a===!0){g();return}x();return}if(l==="Tab"){g();return}if(O!==!1&&!(e.ctrlKey===!0||e.metaKey===!0)&&De(e.keyCode)===!0){const d=Z(o,e.key);if(re(f,d)===!0)return;e.preventDefault()}},[K,a,F,f,G,z,J,y,O,g,x,M,S,b,T]),me=s(function(e){q(e),a!==!0&&(e.preventDefault(),b(),x())},[a,q,b,x]),we=s(function(e){if(Y(e),O===!1)return;if(e.clipboardData===null)throw new Error("`event.clipboardData` is `null`");const o=Z(e.currentTarget,e.clipboardData.getData("Text"));re(f,o)!==!0&&e.preventDefault()},[Y,f,O]),be=s(function(e){i(e);const o=e.currentTarget.getAttribute(v);if(o===null)throw new Error("`id` is `null`");D(o);const l=oe(f,o);if(l===null)throw new Error("`optionValue` is `null`");T(l.value),b(),g()},[i,f,g,b,T]),xe=s(function(e){const o=e.currentTarget.getAttribute(v);if(o===null)throw new Error("`id` is `null`");o!==y&&D(o)},[y]),ye=s(function(){a!==!1&&(g(),S())},[a,S,g]);Ie({onMouseDownOutside:ye,ref:L});const Te=s(function(e){if(A.current=e,V!==null){if(typeof V=="function"){V(e);return}V.current=e}},[V]);return c("div",{ref:L,class:W([w.textbox,typeof N>"u"?null:N==="border"?w.hasBorder:null,typeof r>"u"?null:w.hasIcon,t===!0?w.disabled:null]),children:c("div",{class:w.inner,children:[c("input",{...$,ref:Te,class:w.input,disabled:t===!0,onInput:he,onKeyDown:ge,onMouseDown:me,onPaste:we,placeholder:ce,spellcheck:ae,tabIndex:0,type:"text",value:h}),typeof r>"u"?null:c("div",{class:w.icon,children:r}),c("div",{class:w.border}),N==="underline"?c("div",{class:w.underline}):null,c("div",{ref:P,class:W([m.menu,t===!0||a===!1?m.hidden:null,H===!0?ee.top:ee.bottom]),children:f.map(function(e,o){return typeof e=="string"?c("hr",{class:m.optionSeparator},o):"header"in e?c("h1",{class:m.optionHeader,children:e.header},o):c("label",{class:W([m.optionValue,e.disabled===!0?m.optionValueDisabled:null,e.disabled!==!0&&e.id===y?m.optionValueSelected:null]),children:[c("input",{checked:h===e.value,class:m.input,disabled:e.disabled===!0,onChange:h===e.value?void 0:be,onClick:h===e.value?g:void 0,onMouseMove:xe,tabIndex:-1,type:"radio",value:`${e.value}`,[v]:e.id}),e.value===G?c("div",{class:m.checkIcon,children:c(Ve,{})}):null,e.value]},o)})})]})})});function te(t){return t.map(function(n,r){return typeof n!="string"&&"value"in n?{...n,id:`${r}`}:n})}function Oe(t,n,r){return n===B?t:le(t,n)===p?t.filter(function(u){return typeof u!="string"&&"value"in u?ne(u.value,n)===!0:!1}):r===B?t:t.filter(function(u){return typeof u!="string"&&"value"in u?ne(u.value,r)===!0:!1})}function ne(t,n){return t.toLowerCase().indexOf(n.toLowerCase())!==-1}function le(t,n){for(const r of t)if(typeof r!="string"&&"value"in r&&r.value===n)return r.id;return p}function re(t,n){if(n===B)return!0;for(const r of t)if(typeof r!="string"&&"value"in r&&r.value.toLowerCase().indexOf(n.toLowerCase())===0)return!0;return!1}function oe(t,n){for(const r of t)if(typeof r!="string"&&"id"in r&&r.id===n)return r;return null}function se(t,n){let r=0;for(const i of t){if(typeof i!="string"&&"id"in i&&i.id===n)return r;r+=1}return-1}function Ae(t,n){if(n===p){const u=ue(t,t.length-1);return u===null?null:u.id}const r=se(t,n);if(r===-1)throw new Error(`No option with \`id\` ${n}`);if(r===0)return null;const i=ue(t,r-1);return i===null?null:i.id}function Se(t,n){if(n===p){const u=ie(t,0);return u===null?null:u.id}const r=se(t,n);if(r===-1)throw new Error(`No option with \`id\` ${n}`);if(r===t.length-1)return null;const i=ie(t,r+1);return i===null?null:i.id}function ue(t,n){if(n<0)throw new Error("`index` < 0");if(n>t.length-1)throw new Error("`index` > `options.length` - 1");return _e(t.slice(0,n+1))}function ie(t,n){if(n<0)throw new Error("`index` < 0");if(n>t.length-1)throw new Error("`index` > `options.length` - 1");return fe(t.slice(n))}function fe(t){for(const n of t)if(typeof n!="string"&&"id"in n&&n.disabled!==!0)return n;return null}function _e(t){return fe(t.slice().reverse())}function ke(t,n,r){const i=t.getBoundingClientRect().top,u=r===!0?i-X:window.innerHeight-i-t.offsetHeight-X;n.style.maxHeight=`${u}px`}export{We as T};
//# sourceMappingURL=textbox-autocomplete-8c5643dc.js.map
