import{T as f,c as Z,_ as N,h as P,z as ee}from"./create-component-b0512abd.js";import{u as te,m as T}from"./use-mouse-down-outside-bb94ce97.js";import{g as x}from"./get-current-from-ref-47f174f6.js";import{I as ne}from"./icon-control-chevron-down-8-c2f32eaf.js";import{I as oe}from"./icon-menu-checkmark-checked-16-11f1d34a.js";import{c as R}from"./create-class-name-71c46838.js";import{n as C}from"./no-op-cb277961.js";import{a as q,I as k,V as I}from"./constants-4a59d305.js";import{o as h}from"./jsxRuntime.module-632ba37d.js";function re(n){const{itemIdDataAttributeName:e,menuElementRef:o,selectedId:r,setSelectedId:w}=n,m=f(function(){return Array.from(x(o).querySelectorAll(`[${e}]`)).filter(function(u){return u.hasAttribute("disabled")===!1})},[e,o]),i=f(function(u){if(u===null)return-1;const d=m().findIndex(function(p){return p.getAttribute(e)===u});if(d===-1)throw new Error("`index` is `-1`");return d},[m,e]),_=f(function(u){const d=m(),p=i(u),l=d[p],g=l.getBoundingClientRect().top,a=x(o),y=a.getBoundingClientRect().top;if(g<y){l.scrollIntoView();return}g+l.offsetHeight>y+a.offsetHeight&&l.scrollIntoView()},[i,m,o]),v=f(function(u){const d=u.key;if(d==="ArrowDown"||d==="ArrowUp"){const p=m(),l=i(r);let g;d==="ArrowDown"?g=l===-1||l===p.length-1?0:l+1:g=l===-1||l===0?p.length-1:l-1;const y=p[g].getAttribute(e);w(y),_(y)}},[m,i,e,w,r,_]);return{handleScrollableMenuItemMouseMove:f(function(u){const d=u.currentTarget.getAttribute(e);d!==r&&w(d)},[e,r,w]),handleScrollableMenuKeyDown:v}}const le="_dropdown_1kpqi_1",ie="_disabled_1kpqi_12",ce="_icon_1kpqi_21",se="_empty_1kpqi_33",ue="_value_1kpqi_37",de="_hasIcon_1kpqi_51",ae="_placeholder_1kpqi_55",fe="_chevronIcon_1kpqi_59",pe="_border_1kpqi_70",he="_hasBorder_1kpqi_79",me="_underline_1kpqi_90",b={dropdown:le,disabled:ie,icon:ce,empty:se,value:ue,hasIcon:de,placeholder:ae,chevronIcon:fe,border:pe,hasBorder:he,underline:me};function we(n,e,o){const r=n.getBoundingClientRect(),w=n.offsetWidth,m=n.offsetHeight,i=r.left,_=r.top;e.style.minWidth=`${w}px`;const v=window.innerWidth-2*I;e.style.maxWidth=`${v}px`;const s=window.innerHeight-2*I;e.style.maxHeight=`${s}px`;const u=e.offsetWidth,d=e.offsetHeight,p=e.scrollHeight,l=parseInt(window.getComputedStyle(e).paddingTop,10),g=ge(e,o),a=Ie({menuWidth:u,rootLeft:i});e.style.left=`${a}px`;const y=be({menuHeight:d,rootTop:_,selectedTop:g.offsetTop});e.style.top=`${y}px`,p>d!==!1&&(e.scrollTop=_e({menuHeight:d,menuPaddingTop:l,menuScrollHeight:p,rootHeight:m,rootTop:_,selectedTop:g.offsetTop}))}function ge(n,e){const o=n.querySelector(e===q?`[${k}]`:`[${k}='${e}']`);if(o===null)throw new Error("`inputElement` is `null`");const r=o.parentElement;if(r===null)throw new Error("`labelElement` is `null`");return r}function Ie(n){const{menuWidth:e,rootLeft:o}=n;if(o<=I)return I;const r=window.innerWidth;return o+e>r-I?r-I-e:o}function be(n){const{menuHeight:e,rootTop:o,selectedTop:r}=n,w=window.innerHeight;if(o<=I||e===w-2*I)return I;const m=o-r,i=I,_=w-I-e;return O(m,i,_)}function _e(n){const{menuHeight:e,menuPaddingTop:o,menuScrollHeight:r,rootHeight:w,rootTop:m,selectedTop:i}=n,_=O(m,I,window.innerHeight-I-w+o/2),v=i-(_-I),s=0,u=r-e;return O(v,s,u)}function O(n,e,o){return Math.min(Math.max(n,e),o)}const He=Z(function({disabled:n=!1,icon:e,onChange:o=C,onKeyDown:r=C,onMouseDown:w=C,onValueChange:m=C,options:i,placeholder:_,propagateEscapeKeyDown:v=!0,value:s,variant:u,...d},p){if(typeof e=="string"&&e.length!==1)throw new Error(`String \`icon\` must be a single character: "${e}"`);const l=N(null),g=N(null),[a,y]=P(!1),E=U(i,s);if(s!==null&&E===-1)throw new Error(`Invalid \`value\`: ${s}`);const[S,B]=P(E===-1?q:`${E}`),F=typeof i[E]>"u"?"":ye(i[E]),{handleScrollableMenuKeyDown:L,handleScrollableMenuItemMouseMove:K}=re({itemIdDataAttributeName:k,menuElementRef:g,selectedId:S,setSelectedId:B}),H=f(function(){x(l).blur()},[]),$=f(function(){x(l).focus()},[]),V=f(function(t){const c=x(l),D=x(g);we(c,D,t)},[]),M=f(function(){y(!1),B(q)},[]),A=f(function(){if(a===!0)return;if(y(!0),s===null){V(S);return}const t=U(i,s);if(t===-1)throw new Error(`Invalid \`value\`: ${s}`);const c=`${t}`;B(c),V(c)},[a,i,S,V,s]),z=f(function(t){r(t);const c=t.key;if(c==="ArrowUp"||c==="ArrowDown"){if(t.preventDefault(),a===!1){A();return}L(t);return}if(c==="Escape"){if(t.preventDefault(),v===!1&&t.stopPropagation(),a===!0){M();return}H();return}if(c==="Enter"){if(t.preventDefault(),a===!1){A();return}if(S!==q){const D=x(g).querySelector(`[${k}='${S}']`);if(D===null)throw new Error("`selectedElement` is `null`");D.checked=!0;const W=new window.Event("change",{bubbles:!0,cancelable:!0});D.dispatchEvent(W)}M();return}if(c==="Tab"){M();return}},[L,a,r,v,S,M,A,H]),G=f(function(t){w(t),a===!1&&A()},[a,w,A]),j=f(function(t){t.stopPropagation()},[]),J=f(function(t){o(t);const c=t.currentTarget.getAttribute(k);if(c===null)throw new Error("`id` is `null`");const W=i[parseInt(c,10)].value;m(W),$(),M()},[o,m,i,M,$]),Q=f(function(){$(),M()},[M,$]),X=f(function(){a!==!1&&(M(),H())},[a,H,M]);te({onMouseDownOutside:X,ref:l});const Y=f(function(t){if(l.current=t,p!==null){if(typeof p=="function"){p(t);return}p.current=t}},[p,l]);return h("div",{...d,ref:Y,class:R([b.dropdown,u==="border"?b.hasBorder:null,typeof e<"u"?b.hasIcon:null,n===!0?b.disabled:null]),onKeyDown:n===!0?void 0:z,onMouseDown:G,tabIndex:0,children:[typeof e>"u"?null:h("div",{class:b.icon,children:e}),s===null?typeof _>"u"?h("div",{class:b.empty}):h("div",{class:R([b.value,b.placeholder]),children:_}):h("div",{class:b.value,children:F}),h("div",{class:b.chevronIcon,children:h(ne,{})}),u==="underline"?h("div",{class:b.underline}):null,h("div",{class:b.border}),ee(h("div",{ref:g,class:R([T.menu,b.menu,n===!0||a===!1?T.hidden:null]),onMouseDown:j,children:i.map(function(t,c){return typeof t=="string"?h("hr",{class:T.optionSeparator},c):"header"in t?h("h1",{class:T.optionHeader,children:t.header},c):h("label",{class:R([T.optionValue,t.disabled===!0?T.optionValueDisabled:null,t.disabled!==!0&&`${c}`===S?T.optionValueSelected:null]),children:[h("input",{checked:s===t.value,class:T.input,disabled:t.disabled===!0,onChange:s===t.value?void 0:J,onClick:s===t.value?Q:void 0,onMouseMove:K,tabIndex:-1,type:"radio",value:`${t.value}`,[k]:`${c}`}),t.value===s?h("div",{class:T.checkIcon,children:h(oe,{})}):null,typeof t.text>"u"?t.value:t.text]},c)})}),document.body)]})});function ye(n){if(typeof n!="string"){if("text"in n)return n.text;if("value"in n)return n.value}throw new Error("Invariant violation")}function U(n,e){if(e===null)return-1;let o=0;for(const r of n){if(typeof r!="string"&&"value"in r&&r.value===e)return o;o+=1}return-1}export{He as D};
//# sourceMappingURL=dropdown-73c345bd.js.map
