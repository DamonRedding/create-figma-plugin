{"version":3,"file":"file-upload-button-8a68fcbc.js","sources":["../../src/components/file-upload/file-upload-button/file-upload-button.tsx"],"sourcesContent":["import { ComponentChildren, h, JSX } from 'preact'\nimport { useCallback } from 'preact/hooks'\n\nimport { Props } from '../../../types/types.js'\nimport { createClassName } from '../../../utilities/create-class-name.js'\nimport buttonStyles from '../../button/button.module.css'\nimport { LoadingIndicator } from '../../loading-indicator/loading-indicator.js'\nimport { fileComparator } from '../private/file-comparator.js'\nimport fileUploadButtonStyles from './file-upload-button.module.css'\n\nexport type FileUploadButtonProps = {\n  acceptedFileTypes?: Array<string>\n  children: ComponentChildren\n  disabled?: boolean\n  fullWidth?: boolean\n  loading?: boolean\n  multiple?: boolean\n  onSelectedFiles?: (files: Array<File>) => void\n  propagateEscapeKeyDown?: boolean\n  secondary?: boolean\n}\n\nexport function FileUploadButton({\n  acceptedFileTypes,\n  children,\n  disabled = false,\n  fullWidth = false,\n  loading = false,\n  multiple = false,\n  onSelectedFiles,\n  propagateEscapeKeyDown = true,\n  secondary = false,\n  ...rest\n}: Props<HTMLInputElement, FileUploadButtonProps>): JSX.Element {\n  const handleChange = useCallback(\n    function (event: JSX.TargetedEvent<HTMLInputElement>): void {\n      if (typeof onSelectedFiles === 'undefined') {\n        return\n      }\n      const files = Array.prototype.slice\n        .call(event.currentTarget.files)\n        .sort(fileComparator)\n      onSelectedFiles(files)\n    },\n    [onSelectedFiles]\n  )\n\n  const handleClick = useCallback(\n    function (event: JSX.TargetedMouseEvent<HTMLInputElement>): void {\n      if (disabled === true || loading === true) {\n        event.preventDefault()\n        return\n      }\n      event.currentTarget.focus()\n    },\n    [disabled, loading]\n  )\n\n  const handleKeyDown = useCallback(\n    function (event: JSX.TargetedKeyboardEvent<HTMLInputElement>): void {\n      if (event.key !== 'Escape') {\n        return\n      }\n      if (propagateEscapeKeyDown === false) {\n        event.stopPropagation()\n      }\n      event.currentTarget.blur()\n    },\n    [propagateEscapeKeyDown]\n  )\n\n  const handleLoadingMouseDown = useCallback(function (\n    event: JSX.TargetedMouseEvent<HTMLInputElement>\n  ): void {\n    // This is needed so that the `loading` state behaviour will be identical\n    // to the `Button` component ie. clicking the button will focus it.\n    event.preventDefault()\n    event.currentTarget.focus()\n  },\n  [])\n\n  return (\n    <div\n      class={createClassName([\n        buttonStyles.button,\n        secondary === true ? buttonStyles.secondary : buttonStyles.default,\n        secondary === true\n          ? fileUploadButtonStyles.secondary\n          : fileUploadButtonStyles.default,\n        fullWidth === true ? buttonStyles.fullWidth : null,\n        disabled === true ? buttonStyles.disabled : null,\n        disabled === true ? fileUploadButtonStyles.disabled : null,\n        loading === true ? buttonStyles.loading : null\n      ])}\n    >\n      {loading === true ? (\n        <div class={buttonStyles.loadingIndicator}>\n          <LoadingIndicator />\n        </div>\n      ) : null}\n      <input\n        {...rest}\n        accept={\n          typeof acceptedFileTypes === 'undefined'\n            ? undefined\n            : acceptedFileTypes.join(',')\n        }\n        class={fileUploadButtonStyles.input}\n        disabled={disabled === true}\n        multiple={multiple}\n        onChange={\n          disabled === true || loading === true ? undefined : handleChange\n        }\n        onClick={handleClick}\n        onKeyDown={\n          disabled === true || loading === true ? undefined : handleKeyDown\n        }\n        onMouseDown={loading === true ? handleLoadingMouseDown : undefined}\n        tabIndex={disabled === true ? -1 : 0}\n        title=\"\"\n        type=\"file\"\n      />\n      <button disabled={disabled === true} tabIndex={-1}>\n        <div class={buttonStyles.children}>{children}</div>\n      </button>\n    </div>\n  )\n}\n"],"names":["FileUploadButton","acceptedFileTypes","children","disabled","fullWidth","loading","multiple","onSelectedFiles","propagateEscapeKeyDown","secondary","rest","handleChange","useCallback","event","files","Array","prototype","slice","call","currentTarget","sort","fileComparator","handleClick","preventDefault","focus","handleKeyDown","key","stopPropagation","blur","handleLoadingMouseDown","_jsxs","class","createClassName","buttonStyles","button","default","fileUploadButtonStyles","_jsx","loadingIndicator","LoadingIndicator","accept","undefined","join","input","onChange","onClick","onKeyDown","onMouseDown","tabIndex","title","type"],"mappings":"+aAsBO,SAASA,EAAiB,CAC/BC,kBAAAA,EACAC,SAAAA,EACAC,SAAAA,EAAW,GACXC,UAAAA,EAAY,GACZC,QAAAA,EAAU,GACVC,SAAAA,EAAW,GACXC,gBAAAA,EACAC,uBAAAA,EAAyB,GACzBC,UAAAA,EAAY,GACZ,GAAGC,CAC2C,EAAgB,CACxDC,MAAAA,EAAeC,EACnB,SAAUC,EAAkD,CACtD,GAAA,OAAON,EAAoB,IAC7B,OAEIO,MAAAA,EAAQC,MAAMC,UAAUC,MAC3BC,KAAKL,EAAMM,cAAcL,KAAK,EAC9BM,KAAKC,CAAc,EACtBd,EAAgBO,CAAK,CAAA,EAEvB,CAACP,CAAe,CAClB,EAEMe,EAAcV,EAClB,SAAUC,EAAuD,CAC3DV,GAAAA,IAAa,IAAQE,IAAY,GAAM,CACzCQ,EAAMU,eAAe,EACrB,MACF,CACAV,EAAMM,cAAcK,OAAM,EAE5B,CAACrB,EAAUE,CAAO,CACpB,EAEMoB,EAAgBb,EACpB,SAAUC,EAA0D,CAC9DA,EAAMa,MAAQ,WAGdlB,IAA2B,IAC7BK,EAAMc,gBAAgB,EAExBd,EAAMM,cAAcS,OAAK,EAE3B,CAACpB,CAAsB,CACzB,EAEMqB,EAAyBjB,EAAY,SACzCC,EACM,CAGNA,EAAMU,eAAe,EACrBV,EAAMM,cAAcK,OACtB,EACA,CAAE,CAAA,EAEF,OACEM,EAAA,MAAA,CACEC,MAAOC,EAAgB,CACrBC,EAAaC,OACbzB,IAAc,GAAOwB,EAAaxB,UAAYwB,EAAaE,QAC3D1B,IAAc,GACV2B,EAAuB3B,UACvB2B,EAAuBD,QAC3B/B,IAAc,GAAO6B,EAAa7B,UAAY,KAC9CD,IAAa,GAAO8B,EAAa9B,SAAW,KAC5CA,IAAa,GAAOiC,EAAuBjC,SAAW,KACtDE,IAAY,GAAO4B,EAAa5B,QAAU,IAAI,CAC/C,EAAEH,SAEFG,CAAAA,IAAY,GACXgC,EAAA,MAAA,CAAKN,MAAOE,EAAaK,iBAAiBpC,SACxCmC,EAACE,EAAkB,EAAA,CAAA,CAChB,EACH,KACJF,EAAA,QAAA,CAAA,GACM3B,EACJ8B,OACE,OAAOvC,EAAsB,IACzBwC,OACAxC,EAAkByC,KAAK,GAAG,EAEhCX,MAAOK,EAAuBO,MAC9BxC,SAAUA,IAAa,GACvBG,SAAAA,EACAsC,SACEzC,IAAa,IAAQE,IAAY,GAAOoC,OAAY9B,EAEtDkC,QAASvB,EACTwB,UACE3C,IAAa,IAAQE,IAAY,GAAOoC,OAAYhB,EAEtDsB,YAAa1C,IAAY,GAAOwB,EAAyBY,OACzDO,SAAU7C,IAAa,GAAO,GAAK,EACnC8C,MAAM,GACNC,KAAK,MAAA,CACN,EACDb,EAAA,SAAA,CAAQlC,SAAUA,IAAa,GAAM6C,SAAU,GAAG9C,SAChDmC,EAAA,MAAA,CAAKN,MAAOE,EAAa/B,SAASA,SAAAA,CAAAA,CAAgB,CAAA,CAC5C,CAAC,CAAA,CACN,CAET"}